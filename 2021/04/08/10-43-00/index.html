<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1"><meta http-equiv="X-UA-Compatible" content="ie=edge"><meta name="author" content="JiangHu295"><meta name="subtitle" content="你来我往，各凭技艺，<br>人在江湖，奋斗不息。"><meta name="description" content="输出是最好的学习方式"><title>Oracle数据库（续3） | JiangHu295</title><link rel="icon" href="/favicon.ico"><link rel="stylesheet" href="/css/style.css"><script src="/js/script.js"></script><script src="/js/tocbot.min.js"></script><meta name="generator" content="Hexo 5.4.0"></head><body><div class="wrapper"><header><nav class="navbar"><div class="container"><div class="navbar-header header-logo"><a href="/">JiangHu&#39;s Blog</a></div><div class="menu navbar-right"><a class="menu-item" href="/archives">Posts</a> <a class="menu-item" href="/category">Categories</a> <a class="menu-item" href="/tag">Tags</a> <a class="menu-item" href="/about">About</a> <input id="switch_default" type="checkbox" class="switch_default"> <label for="switch_default" class="toggleBtn"></label></div></div></nav><nav class="navbar-mobile" id="nav-mobile"><div class="container"><div class="navbar-header"><div><a href="/">JiangHu&#39;s Blog</a><a id="mobile-toggle-theme">·&nbsp;Light</a></div><div class="menu-toggle" onclick="mobileBtn()">&#9776; Menu</div></div><div class="menu" id="mobile-menu"><a class="menu-item" href="/archives">Posts</a> <a class="menu-item" href="/category">Categories</a> <a class="menu-item" href="/tag">Tags</a> <a class="menu-item" href="/about">About</a></div></div></nav></header><script>var mobileBtn=function(){var e=document.getElementsByClassName("menu-toggle")[0],t=document.getElementById("mobile-menu");e.classList.contains("active")?(e.classList.remove("active"),t.classList.remove("active")):(e.classList.add("active"),t.classList.add("active"))}</script><div class="main"><div class="container"><div class="post-toc"><div class="tocbot-list"></div><div class="tocbot-list-menu"><a class="tocbot-toc-expand" onclick="expand_toc()">Expand all</a> <a onclick="go_top()">Back to top</a> <a onclick="go_bottom()">Go to bottom</a></div></div><script>function expand_toc(){var o=document.querySelector(".tocbot-toc-expand");tocbot.init({tocSelector:".tocbot-list",contentSelector:".post-content",headingSelector:"h1, h2, h3, h4, h5",collapseDepth:6,orderedList:!1,scrollSmooth:!0}),o.setAttribute("onclick","collapse_toc()"),o.innerHTML="Collapse all"}function collapse_toc(){var o=document.querySelector(".tocbot-toc-expand");tocbot.init({tocSelector:".tocbot-list",contentSelector:".post-content",headingSelector:"h1, h2, h3, h4, h5",collapseDepth:1,orderedList:!1,scrollSmooth:!0}),o.setAttribute("onclick","expand_toc()"),o.innerHTML="Expand all"}function go_top(){window.scrollTo(0,0)}function go_bottom(){window.scrollTo(0,document.body.scrollHeight)}document.ready(function(){tocbot.init({tocSelector:".tocbot-list",contentSelector:".post-content",headingSelector:"h1, h2, h3, h4, h5",collapseDepth:1,orderedList:!1,scrollSmooth:!0})})</script><article class="post-wrap"><header class="post-header"><h1 class="post-title">Oracle数据库（续3）</h1><div class="post-meta">Author: <a itemprop="author" rel="author" href="/">JiangHu295</a> <span class="post-time">Date: <a href="#">四月 8, 2021&nbsp;&nbsp;10:43:00</a> </span><span class="post-category">Category: <a href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a></span></div></header><div class="post-content"><h2 id="集合操作"><a href="#集合操作" class="headerlink" title="集合操作"></a>集合操作</h2><p>在SQL语句中集合操作有：交、差、并，可以使用以下的几个操作完成：</p><ul><li>UINON：将多个查询结果合并到一个结果之中，没有重复的内容。</li><li>UNION ALL：将多个结果合并到一个结果之中，可以有重复的内容。</li><li>INTERSECT：返回多个查询结果中相同的部分。</li><li>MINUS：返回两个查询结果中的差集。</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- UNION ALL</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> dept</span><br><span class="line"><span class="keyword">UNION</span> <span class="keyword">ALL</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> dept1;</span><br><span class="line"><span class="comment">-- UNION</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> dept</span><br><span class="line"><span class="keyword">UNION</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> dept1;</span><br><span class="line"><span class="comment">-- INTERSECT</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> dept</span><br><span class="line"><span class="keyword">INTERSECT</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> dept1;</span><br><span class="line"><span class="comment">-- MINUS</span></span><br><span class="line"><span class="comment">-- 前面的结果减去后面的结果</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> dept</span><br><span class="line">MINUS</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> dept1;</span><br></pre></td></tr></table></figure><p>练习</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--  取出部门最高的工资的名字和部门最低工资的名字</span></span><br><span class="line"><span class="keyword">SELECT</span>  ename <span class="keyword">FROM</span> emp e,</span><br><span class="line">(<span class="keyword">SELECT</span> deptno,<span class="built_in">MAX</span>(sal) s <span class="keyword">FROM</span> emp <span class="keyword">GROUP</span> <span class="keyword">BY</span>  deptno)t1</span><br><span class="line"><span class="keyword">WHERE</span> e.deptno<span class="operator">=</span>t1.deptno</span><br><span class="line"><span class="keyword">AND</span> e.sal<span class="operator">=</span>t1.s</span><br><span class="line"><span class="keyword">UNION</span></span><br><span class="line"><span class="keyword">SELECT</span>  ename <span class="keyword">FROM</span> emp e,</span><br><span class="line">(<span class="keyword">SELECT</span> deptno,<span class="built_in">MIN</span>(sal) s <span class="keyword">FROM</span> emp <span class="keyword">GROUP</span> <span class="keyword">BY</span>  deptno)t1</span><br><span class="line"><span class="keyword">WHERE</span> e.deptno<span class="operator">=</span>t1.deptno</span><br><span class="line"><span class="keyword">AND</span> e.sal<span class="operator">=</span>t1.s;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 取出没有原工的部门编号</span></span><br><span class="line"><span class="keyword">SELECT</span> deptno <span class="keyword">FROM</span> dept</span><br><span class="line">MINUS</span><br><span class="line"><span class="keyword">SELECT</span> deptno <span class="keyword">FROM</span> emp;</span><br><span class="line"></span><br><span class="line"><span class="comment">--取出不是领导的员工编号</span></span><br><span class="line"><span class="keyword">SELECT</span> empno <span class="keyword">FROM</span> emp</span><br><span class="line">minus</span><br><span class="line"><span class="keyword">SELECT</span> mgr <span class="keyword">FROM</span> emp;</span><br></pre></td></tr></table></figure><h2 id="数据库对象"><a href="#数据库对象" class="headerlink" title="数据库对象"></a>数据库对象</h2><h3 id="同义词-了解"><a href="#同义词-了解" class="headerlink" title="同义词(了解)"></a>同义词(了解)</h3><p>同义词是现有对象的一个别名。</p><ul><li>简化SQL语句</li><li>隐藏对象的名称和所有者</li><li>提供对对象的公共访问</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 公共的同义词,可以跟表名相同</span></span><br><span class="line"><span class="keyword">CREATE</span> PUBLIC SYNONYM emp1 <span class="keyword">FOR</span> emp1;</span><br><span class="line"><span class="comment">-- 私有的同义词不允许跟表名相同</span></span><br><span class="line"><span class="keyword">CREATE</span> SYNONYM emp3 <span class="keyword">FOR</span> emp3;</span><br><span class="line"><span class="comment">-- 私有的同义词跟公共的同义词可以同名，因为存储地方不一样,私有的同义词在自己的 Synonyms 目录下可以看到</span></span><br><span class="line"><span class="keyword">CREATE</span> SYNONYM emp_sy <span class="keyword">FOR</span> emp4;</span><br><span class="line"><span class="keyword">CREATE</span> PUBLIC SYNONYM emp_sy <span class="keyword">FOR</span> emp4;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 删除私有同义词</span></span><br><span class="line"><span class="keyword">DROP</span> SYNONYM emp_sy;</span><br></pre></td></tr></table></figure><h3 id="序列"><a href="#序列" class="headerlink" title="序列"></a>序列</h3><ul><li>序列是用于生成唯一、连续序号的对象</li><li>序列可以是升序的，也可以是降序的</li><li>使用CREATE SEQUENCE语句创建序列</li><li>使用ALTER SEQUENCE语句修改序列，不能更改序列的 START WITH 参数</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> SEQUENCE sq1;</span><br><span class="line"><span class="comment">-- 通过序列的伪列来访问序列的值</span></span><br><span class="line"><span class="comment">-- NEXTVAL 返回序列的下一个值</span></span><br><span class="line"><span class="comment">-- CURRVAL 返回序列的当前值，第一次不可以使用 currval</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> SEQUENCE toys_seq</span><br><span class="line">	<span class="keyword">START</span> <span class="keyword">WITH</span> <span class="number">10</span> <span class="comment">-- 初始值</span></span><br><span class="line">	INCREMENT <span class="keyword">BY</span> <span class="number">10</span> <span class="comment">-- 增量</span></span><br><span class="line">	MAXVALUE <span class="number">200</span> <span class="comment">-- 最大值</span></span><br><span class="line">	MINVALUE <span class="number">10</span> <span class="comment">-- 最小值</span></span><br><span class="line">	NOCYCLE <span class="comment">-- 不循环</span></span><br><span class="line">	CACHE <span class="number">10</span>; <span class="comment">-- 缓存</span></span><br><span class="line">  </span><br><span class="line"><span class="keyword">SELECT</span> toys_seq.NEXTVAL <span class="keyword">FROM</span> dual;</span><br><span class="line"><span class="keyword">SELECT</span> toys_seq.CURRVAL <span class="keyword">FROM</span> dual;</span><br></pre></td></tr></table></figure><p>练习</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 使用数据字典视图user_sequences查询序列的信息</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> User_Sequences;</span><br><span class="line"><span class="comment">-- 使用下列语句向表中插入数据</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> dept2 <span class="keyword">AS</span> <span class="keyword">SELECT</span> deptno,dname <span class="keyword">FROM</span> dept;</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> dept2(deptno,dname)</span><br><span class="line"><span class="keyword">VALUES</span>(dept_id_seq.NEXTVAL,<span class="string">&#x27;Education&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> dept2</span><br><span class="line"><span class="keyword">VALUES</span>(dept_id_seq.NEXTVAL,<span class="string">&#x27;Administration&#x27;</span>);</span><br></pre></td></tr></table></figure><h3 id="视图"><a href="#视图" class="headerlink" title="视图"></a>视图</h3><blockquote><p>视图以经过定制的方式显示来自一个或多个表的数据<br>视图可以视为“虚拟表”或“存储的查询”<br>创建视图所依据的表称为“基表”</p></blockquote><p>视图的优点有：</p><ul><li>提供了<strong>另外一种级别的表安全性</strong></li><li><strong>隐藏的数据的复杂性</strong></li><li>简化的用户的SQL命令</li><li>隔离基表结构的改变</li><li>通过重命名列，从另一个角度提供数据</li></ul><p>创建视图的语法</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> [<span class="keyword">OR</span> REPLACE] [FORCE] <span class="keyword">VIEW</span> view_name [(alias[, alias]...)] <span class="comment">-- force 强制生成</span></span><br><span class="line">  <span class="keyword">AS</span> select_statement</span><br><span class="line">  [<span class="keyword">WITH</span> <span class="keyword">CHECK</span> OPTION] <span class="comment">-- 不允许更改 违反产生视图的条件的值</span></span><br><span class="line">  [<span class="keyword">WITH</span> READ <span class="keyword">ONLY</span>]; <span class="comment">-- 只读</span></span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span>  <span class="keyword">OR</span> REPLACE <span class="keyword">VIEW</span> V_emp </span><br><span class="line"><span class="keyword">AS</span> <span class="keyword">SELECT</span> empno,ename ,sal <span class="keyword">FROM</span> emp</span><br><span class="line"><span class="keyword">WITH</span> READ <span class="keyword">ONLY</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> v_emp</span><br><span class="line"></span><br><span class="line">UPDATE v_emp <span class="keyword">SET</span> sal<span class="operator">=</span><span class="number">2200</span></span><br><span class="line"><span class="keyword">WHERE</span> empno<span class="operator">=</span><span class="number">7369</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> V_emp</span><br><span class="line"><span class="keyword">WHERE</span> empno<span class="operator">=</span><span class="number">7369</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span>  <span class="keyword">OR</span> REPLACE <span class="keyword">VIEW</span> V_emp2 </span><br><span class="line"><span class="keyword">AS</span> <span class="keyword">SELECT</span> empno,ename ,sal <span class="keyword">FROM</span> emp</span><br><span class="line"><span class="keyword">WHERE</span> sal<span class="operator">&gt;</span><span class="number">2000</span></span><br><span class="line"><span class="keyword">WITH</span> <span class="keyword">CHECK</span> OPTION</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> v_emp2</span><br><span class="line"></span><br><span class="line">UPDATE v_emp2 <span class="keyword">SET</span> sal<span class="operator">=</span><span class="number">5000</span></span><br><span class="line"><span class="keyword">WHERE</span> empno<span class="operator">=</span><span class="number">7782</span></span><br><span class="line"></span><br><span class="line">UPDATE v_emp2</span><br><span class="line"><span class="keyword">SET</span> ename<span class="operator">=</span><span class="string">&#x27;zs&#x27;</span></span><br><span class="line"><span class="keyword">WHERE</span> empno<span class="operator">=</span><span class="number">7698</span></span><br><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> v_emp2</span><br><span class="line"><span class="keyword">WHERE</span> empno<span class="operator">=</span><span class="number">7698</span></span><br></pre></td></tr></table></figure><h3 id="索引"><a href="#索引" class="headerlink" title="索引"></a>索引</h3><ul><li>索引是与表相关的一个可选结构</li><li><strong>用以提高 SQL 语句执行的性能</strong></li><li><strong>减少磁盘I/O</strong></li><li>使用 CREATE INDEX 语句创建索引</li><li>在逻辑上和物理上都独立于表的数据</li><li>Oracle 自动维护索引</li></ul><h4 id="标准索引"><a href="#标准索引" class="headerlink" title="标准索引"></a>标准索引</h4><p>创建和删除索引</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建标准索引</span></span><br><span class="line"><span class="keyword">CREATE</span> INDEX emp1_i1 <span class="keyword">ON</span> emp1(empno);</span><br><span class="line"><span class="comment">-- 重建索引</span></span><br><span class="line"><span class="keyword">ALTER</span> INDEX emp1_i1 REBUILD;</span><br><span class="line"><span class="comment">-- 删除索引</span></span><br><span class="line"><span class="keyword">DROP</span> INDEX emp1_i1;</span><br></pre></td></tr></table></figure><h4 id="唯一索引"><a href="#唯一索引" class="headerlink" title="唯一索引"></a>唯一索引</h4><p><code>CREATE UNIQUE INDEX emp1_index2 ON emp1 (ename);</code></p><ul><li>唯一索引确保在定义索引的列中没有重复值</li><li>Oracle 自动在表的主键列上创建唯一索引</li><li>使用CREATE UNIQUE INDEX语句创建唯一索引</li></ul><h4 id="组合索引"><a href="#组合索引" class="headerlink" title="组合索引"></a>组合索引</h4><p><code>CREATE INDEX emp2_index3 ON emp (mgr,job);</code></p><ul><li>组合索引是在表的多个列上创建的索引</li><li>索引中列的顺序是任意的</li><li>如果 SQL 语句的 WHERE 子句中引用了组合索引的所有列或大多数列，则可以提高检索速度</li></ul><h4 id="反向键索引"><a href="#反向键索引" class="headerlink" title="反向键索引"></a>反向键索引</h4><p><code>CREATE INDEX emp2_index4 ON emp2 (empno) REVERSE;</code></p><ul><li>反向键索引反转索引列键值的每个字节</li><li>通常建立在值是连续增长的列上，使数据均匀地分布在整个索引上,比如 number 类型</li><li>创建索引时使用REVERSE关键字</li></ul><h4 id="位图索引（xe版本不支持）"><a href="#位图索引（xe版本不支持）" class="headerlink" title="位图索引（xe版本不支持）"></a>位图索引（xe版本不支持）</h4><p><code>CREATE BITMAP INDEX bit_index ON person (sex);</code></p><ul><li>位图索引适合创建在低基数列上,比如 sex</li><li>位图索引不直接存储ROWID，而是存储字节位到ROWID的映射</li><li>减少响应时间</li><li>节省空间占用</li></ul><h4 id="基于函数的索引"><a href="#基于函数的索引" class="headerlink" title="基于函数的索引"></a>基于函数的索引</h4><p><code>CREATE INDEX lowercase_idx ON emp (Upper(ename));</code></p><ul><li>基于一个或多个列上的函数或表达式创建的索引</li><li>表达式中不能出现聚合函数</li><li>不能在LOB类型的列上创建</li><li>创建时必须具有 QUERY REWRITE 权限</li></ul></div><section class="post-copyright"><p class="copyright-item"><span>Author:</span> <span>JiangHu295</span></p><p class="copyright-item"><span>Permalink:</span> <span><a href="https://jianghu295.github.io/2021/04/08/10-43-00/">https://jianghu295.github.io/2021/04/08/10-43-00/</a></span></p><p class="copyright-item"><span>License:</span> <span>Copyright (c) 2021 <a target="_blank" rel="noopener" href="http://creativecommons.org/licenses/by-nc/4.0/">CC-BY-NC-4.0</a> LICENSE</span></p><p class="copyright-item"><span>Slogan:</span> <span><strong>花有重开日，人无再少年。</strong></span></p></section><section class="post-tags"><div><span>Tag(s):</span> <span class="tag"><a href="/tags/Oracle/"># Oracle</a></span></div><div><a href="javascript:window.history.back();">back</a> <span>· </span><a href="/">home</a></div></section><section class="post-nav"><a class="prev" rel="prev" href="/2021/04/11/22-39-12/">Oracle和MySQL区别</a> <a class="next" rel="next" href="/2021/04/07/08-43-35/">Oracle数据库（续2）</a></section></article></div></div><footer id="footer" class="footer"><div class="copyright"><span>© JiangHu295 | AiWenLiang</span></div></footer></div></body></html>